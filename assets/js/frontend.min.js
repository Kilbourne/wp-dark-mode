/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 1);
/******/ })
/************************************************************************/
/******/ ({

/***/ "./assets/js/frontend.js":
/*!*******************************!*\
  !*** ./assets/js/frontend.js ***!
  \*******************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


;

(function () {
  var app = {
    init: function init() {
      if (typeof wpDarkModeFrontend !== 'undefined' && wpDarkModeFrontend.is_excluded) {
        return;
      }

      if (typeof elementor === 'undefined') {
        app.initDarkmode();
      } //app.sessionTransfer();


      if (typeof wpDarkModeAdmin === 'undefined') {
        if (sessionStorage.getItem('wp_dark_mode_frontend') != 0) {
          //block from admin side
          app.checkOsMode();
        }
      }

      app.excludeBGELements();
      document.querySelector('.wp-dark-mode-switch').addEventListener('click', app.handleToggle);
      document.querySelector('.wp-dark-mode-switch').addEventListener('change', app.handleExcludes);
      app.checkDarkMode();
      app.handleExcludes();
      window.addEventListener('darkmodeInit', app.checkDarkMode);
      window.addEventListener('darkmodeInit', app.handleExcludes);
    },
    sessionTransfer: function sessionTransfer() {
      // transfers sessionStorage from one tab to another
      var sessionStorage_transfer = function sessionStorage_transfer(event) {
        if (!event) {
          event = window.event;
        } // ie suq


        if (!event.newValue) return; // do nothing if no value to work with

        if (event.key == 'getSessionStorage') {
          // another tab asked for the sessionStorage -> send it
          localStorage.setItem('sessionStorage', JSON.stringify(sessionStorage)); // the other tab should now have it, so we're done with it.

          localStorage.removeItem('sessionStorage'); // <- could do short timeout as well.
        } else if (event.key == 'sessionStorage' && !sessionStorage.length) {
          // another tab sent data <- get it
          var data = JSON.parse(event.newValue);

          for (var key in data) {
            sessionStorage.setItem(key, data[key]);
          }
        }
      }; // listen for changes to localStorage


      if (window.addEventListener) {
        window.addEventListener("storage", sessionStorage_transfer, false);
      } else {
        window.attachEvent("onstorage", sessionStorage_transfer);
      } // Ask other tabs for session storage (this is ONLY to trigger event)


      if (!sessionStorage.length) {
        localStorage.setItem('getSessionStorage', 'foobar');
        localStorage.removeItem('getSessionStorage', 'foobar');
      }
    },
    initDarkmode: function initDarkmode() {
      if (typeof wpDarkModeAdmin !== 'undefined') {
        return;
      }

      var is_saved = sessionStorage.getItem('wp_dark_mode_frontend');

      if (1 == is_saved) {
        document.querySelector('html').classList.add('wp-dark-mode-active');
        app.checkDarkMode();
      }

      window.dispatchEvent(new Event('darkmodeInit'));
    },
    excludeBGELements: function excludeBGELements() {
      var elements = document.querySelectorAll('div, section');
      elements.forEach(function (element) {
        var bi = window.getComputedStyle(element, false).backgroundImage;

        if (bi !== 'none') {
          element.classList.add('wp-dark-mode-ignore');
          element.querySelectorAll('*').forEach(function (child) {
            return child.classList.add('wp-dark-mode-ignore');
          });
        }
      });
    },
    handleToggle: function handleToggle() {
      var html = document.querySelector('html');
      html.classList.toggle('wp-dark-mode-active');
      document.querySelectorAll('.wp-dark-mode-switcher').forEach(function (switcher) {
        return switcher.classList.toggle('active');
      });
      app.checkDarkMode();
      var is_saved = html.classList.contains('wp-dark-mode-active') ? 1 : 0;

      if (typeof wpDarkModeAdmin === 'undefined') {
        sessionStorage.setItem('wp_dark_mode_frontend', is_saved);
      } else {
        sessionStorage.setItem('wp_dark_mode_admin', is_saved);
      }

      window.dispatchEvent(new Event('darkmodeInit'));
    },

    /** check if the darkmode is active or not on initialize */
    checkDarkMode: function checkDarkMode() {
      if (document.querySelector('html').classList.contains('wp-dark-mode-active')) {
        document.querySelectorAll('.wp-dark-mode-switcher').forEach(function (switcher) {
          return switcher.classList.add('active');
        });
      } else {
        document.querySelectorAll('.wp-dark-mode-switcher').forEach(function (switcher) {
          return switcher.classList.remove('active');
        });
      }
    },
    checkOsMode: function checkOsMode() {
      if (!wpDarkModeFrontend.enable_os_mode) {
        return;
      }

      var darkMediaQuery = window.matchMedia('(prefers-color-scheme: dark)');

      try {
        // Chrome & Firefox
        darkMediaQuery.addEventListener('change', function (e) {
          var newColorScheme = e.matches ? 'dark' : 'light';

          if ('dark' === newColorScheme) {
            document.querySelector('html').classList.add('wp-dark-mode-active');
          } else {
            document.querySelector('html').classList.remove('wp-dark-mode-active');
          }

          window.dispatchEvent(new Event('darkmodeInit'));
        });
      } catch (e1) {
        try {
          // Safari
          darkMediaQuery.addListener(function (e) {
            var newColorScheme = e.matches ? 'dark' : 'light';

            if ('dark' === newColorScheme) {
              document.querySelector('html').classList.add('wp-dark-mode-active');
            } else {
              document.querySelector('html').classList.remove('wp-dark-mode-active');
            }

            window.dispatchEvent(new Event('darkmodeInit'));
          });
        } catch (e2) {
          console.error(e2);
        }
      }
      /** check init dark theme */


      if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector('html').classList.add('wp-dark-mode-active');
        window.dispatchEvent(new Event('darkmodeInit'));
      }
    },
    handleExcludes: function handleExcludes() {
      if (typeof wpDarkModeFrontend === 'undefined') {
        return;
      }

      var elements = document.querySelectorAll(wpDarkModeFrontend.excludes);
      elements.forEach(function (element) {
        element.classList.add('wp-dark-mode-ignore');
        var children = element.querySelectorAll('*');
        children.forEach(function (child) {
          child.classList.add('wp-dark-mode-ignore');
        });
      });
    }
  };
  document.addEventListener('DOMContentLoaded', app.init);
})();

/***/ }),

/***/ 1:
/*!*************************************!*\
  !*** multi ./assets/js/frontend.js ***!
  \*************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__(/*! C:\xampp\htdocs\wp-dark-mode\wp-content\plugins\wp-dark-mode\assets\js\frontend.js */"./assets/js/frontend.js");


/***/ })

/******/ });
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vYXNzZXRzL2pzL2Zyb250ZW5kLmpzIl0sIm5hbWVzIjpbImFwcCIsImluaXQiLCJ3cERhcmtNb2RlRnJvbnRlbmQiLCJpc19leGNsdWRlZCIsImVsZW1lbnRvciIsImluaXREYXJrbW9kZSIsIndwRGFya01vZGVBZG1pbiIsInNlc3Npb25TdG9yYWdlIiwiZ2V0SXRlbSIsImNoZWNrT3NNb2RlIiwiZXhjbHVkZUJHRUxlbWVudHMiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJhZGRFdmVudExpc3RlbmVyIiwiaGFuZGxlVG9nZ2xlIiwiaGFuZGxlRXhjbHVkZXMiLCJjaGVja0RhcmtNb2RlIiwid2luZG93Iiwic2Vzc2lvblRyYW5zZmVyIiwic2Vzc2lvblN0b3JhZ2VfdHJhbnNmZXIiLCJldmVudCIsIm5ld1ZhbHVlIiwia2V5IiwibG9jYWxTdG9yYWdlIiwic2V0SXRlbSIsIkpTT04iLCJzdHJpbmdpZnkiLCJyZW1vdmVJdGVtIiwibGVuZ3RoIiwiZGF0YSIsInBhcnNlIiwiYXR0YWNoRXZlbnQiLCJpc19zYXZlZCIsImNsYXNzTGlzdCIsImFkZCIsImRpc3BhdGNoRXZlbnQiLCJFdmVudCIsImVsZW1lbnRzIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJlbGVtZW50IiwiYmkiLCJnZXRDb21wdXRlZFN0eWxlIiwiYmFja2dyb3VuZEltYWdlIiwiY2hpbGQiLCJodG1sIiwidG9nZ2xlIiwic3dpdGNoZXIiLCJjb250YWlucyIsInJlbW92ZSIsImVuYWJsZV9vc19tb2RlIiwiZGFya01lZGlhUXVlcnkiLCJtYXRjaE1lZGlhIiwiZSIsIm5ld0NvbG9yU2NoZW1lIiwibWF0Y2hlcyIsImUxIiwiYWRkTGlzdGVuZXIiLCJlMiIsImNvbnNvbGUiLCJlcnJvciIsImV4Y2x1ZGVzIiwiY2hpbGRyZW4iXSwibWFwcGluZ3MiOiI7UUFBQTtRQUNBOztRQUVBO1FBQ0E7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a0JBQVAsS0FBOEIsV0FBbEMsRUFBK0M7QUFDM0M7QUFDSDs7QUFFRCxVQUFNbUMsUUFBUSxHQUFHMUIsUUFBUSxDQUFDMkIsZ0JBQVQsQ0FBMEJwQyxrQkFBa0IsQ0FBQzJELFFBQTdDLENBQWpCO0FBRUF4QixjQUFRLENBQUNFLE9BQVQsQ0FBaUIsVUFBQ0MsT0FBRCxFQUFhO0FBQzFCQSxlQUFPLENBQUNQLFNBQVIsQ0FBa0JDLEdBQWxCLENBQXNCLHFCQUF0QjtBQUNBLFlBQU00QixRQUFRLEdBQUd0QixPQUFPLENBQUNGLGdCQUFSLENBQXlCLEdBQXpCLENBQWpCO0FBRUF3QixnQkFBUSxDQUFDdkIsT0FBVCxDQUFpQixVQUFDSyxLQUFELEVBQVc7QUFDeEJBLGVBQUssQ0FBQ1gsU0FBTixDQUFnQkMsR0FBaEIsQ0FBb0IscUJBQXBCO0FBQ0gsU0FGRDtBQUdILE9BUEQ7QUFRSDtBQWxNTyxHQUFaO0FBc01BdkIsVUFBUSxDQUFDRSxnQkFBVCxDQUEwQixrQkFBMUIsRUFBOENiLEdBQUcsQ0FBQ0MsSUFBbEQ7QUFFSCxDQXpNQSxJIiwiZmlsZSI6ImZyb250ZW5kLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDEpO1xuIiwiOyhmdW5jdGlvbiAoKSB7XHJcbiAgICBjb25zdCBhcHAgPSB7XHJcblxyXG4gICAgICAgIGluaXQ6ICgpID0+IHtcclxuXHJcbiAgICAgICAgICAgIGlmICh0eXBlb2Ygd3BEYXJrTW9kZUZyb250ZW5kICE9PSAndW5kZWZpbmVkJyAmJiB3cERhcmtNb2RlRnJvbnRlbmQuaXNfZXhjbHVkZWQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBlbGVtZW50b3IgPT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgICAgICAgICBhcHAuaW5pdERhcmttb2RlKCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vYXBwLnNlc3Npb25UcmFuc2ZlcigpO1xyXG5cclxuICAgICAgICAgICAgaWYgKHR5cGVvZiB3cERhcmtNb2RlQWRtaW4gPT09ICd1bmRlZmluZWQnKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ3dwX2RhcmtfbW9kZV9mcm9udGVuZCcpICE9IDApIHsgLy9ibG9jayBmcm9tIGFkbWluIHNpZGVcclxuICAgICAgICAgICAgICAgICAgICBhcHAuY2hlY2tPc01vZGUoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXBwLmV4Y2x1ZGVCR0VMZW1lbnRzKCk7XHJcblxyXG4gICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcud3AtZGFyay1tb2RlLXN3aXRjaCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXBwLmhhbmRsZVRvZ2dsZSk7XHJcblxyXG4gICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcud3AtZGFyay1tb2RlLXN3aXRjaCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGFwcC5oYW5kbGVFeGNsdWRlcyk7XHJcblxyXG4gICAgICAgICAgICBhcHAuY2hlY2tEYXJrTW9kZSgpO1xyXG4gICAgICAgICAgICBhcHAuaGFuZGxlRXhjbHVkZXMoKTtcclxuXHJcbiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdkYXJrbW9kZUluaXQnLCBhcHAuY2hlY2tEYXJrTW9kZSk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdkYXJrbW9kZUluaXQnLCBhcHAuaGFuZGxlRXhjbHVkZXMpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIHNlc3Npb25UcmFuc2ZlcjogKCkgPT4ge1xyXG4gICAgICAgICAgICAvLyB0cmFuc2ZlcnMgc2Vzc2lvblN0b3JhZ2UgZnJvbSBvbmUgdGFiIHRvIGFub3RoZXJcclxuICAgICAgICAgICAgdmFyIHNlc3Npb25TdG9yYWdlX3RyYW5zZmVyID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKCFldmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50ID0gd2luZG93LmV2ZW50O1xyXG4gICAgICAgICAgICAgICAgfSAvLyBpZSBzdXFcclxuICAgICAgICAgICAgICAgIGlmICghZXZlbnQubmV3VmFsdWUpIHJldHVybjsgICAgICAgICAgLy8gZG8gbm90aGluZyBpZiBubyB2YWx1ZSB0byB3b3JrIHdpdGhcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoZXZlbnQua2V5ID09ICdnZXRTZXNzaW9uU3RvcmFnZScpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBhbm90aGVyIHRhYiBhc2tlZCBmb3IgdGhlIHNlc3Npb25TdG9yYWdlIC0+IHNlbmQgaXRcclxuICAgICAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnc2Vzc2lvblN0b3JhZ2UnLCBKU09OLnN0cmluZ2lmeShzZXNzaW9uU3RvcmFnZSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHRoZSBvdGhlciB0YWIgc2hvdWxkIG5vdyBoYXZlIGl0LCBzbyB3ZSdyZSBkb25lIHdpdGggaXQuXHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ3Nlc3Npb25TdG9yYWdlJyk7IC8vIDwtIGNvdWxkIGRvIHNob3J0IHRpbWVvdXQgYXMgd2VsbC5cclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnQua2V5ID09ICdzZXNzaW9uU3RvcmFnZScgJiYgIXNlc3Npb25TdG9yYWdlLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGFub3RoZXIgdGFiIHNlbnQgZGF0YSA8LSBnZXQgaXRcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IEpTT04ucGFyc2UoZXZlbnQubmV3VmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oa2V5LCBkYXRhW2tleV0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIC8vIGxpc3RlbiBmb3IgY2hhbmdlcyB0byBsb2NhbFN0b3JhZ2VcclxuICAgICAgICAgICAgaWYgKHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKSB7XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInN0b3JhZ2VcIiwgc2Vzc2lvblN0b3JhZ2VfdHJhbnNmZXIsIGZhbHNlKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5hdHRhY2hFdmVudChcIm9uc3RvcmFnZVwiLCBzZXNzaW9uU3RvcmFnZV90cmFuc2Zlcik7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIEFzayBvdGhlciB0YWJzIGZvciBzZXNzaW9uIHN0b3JhZ2UgKHRoaXMgaXMgT05MWSB0byB0cmlnZ2VyIGV2ZW50KVxyXG4gICAgICAgICAgICBpZiAoIXNlc3Npb25TdG9yYWdlLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2dldFNlc3Npb25TdG9yYWdlJywgJ2Zvb2JhcicpO1xyXG4gICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ2dldFNlc3Npb25TdG9yYWdlJywgJ2Zvb2JhcicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgaW5pdERhcmttb2RlOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgICAgICBpZiAodHlwZW9mIHdwRGFya01vZGVBZG1pbiAhPT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdmFyIGlzX3NhdmVkID0gc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgnd3BfZGFya19tb2RlX2Zyb250ZW5kJyk7XHJcblxyXG4gICAgICAgICAgICBpZiAoMSA9PSBpc19zYXZlZCkge1xyXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaHRtbCcpLmNsYXNzTGlzdC5hZGQoJ3dwLWRhcmstbW9kZS1hY3RpdmUnKTtcclxuICAgICAgICAgICAgICAgIGFwcC5jaGVja0RhcmtNb2RlKCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnZGFya21vZGVJbml0JykpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGV4Y2x1ZGVCR0VMZW1lbnRzOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVsZW1lbnRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnZGl2LCBzZWN0aW9uJyk7XHJcblxyXG4gICAgICAgICAgICBlbGVtZW50cy5mb3JFYWNoKChlbGVtZW50KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBiaSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGVsZW1lbnQsIGZhbHNlKS5iYWNrZ3JvdW5kSW1hZ2U7XHJcbiAgICAgICAgICAgICAgICBpZiAoYmkgIT09ICdub25lJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnd3AtZGFyay1tb2RlLWlnbm9yZScpO1xyXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnKicpLmZvckVhY2goKGNoaWxkKSA9PiBjaGlsZC5jbGFzc0xpc3QuYWRkKCd3cC1kYXJrLW1vZGUtaWdub3JlJykpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgaGFuZGxlVG9nZ2xlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGh0bWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdodG1sJyk7XHJcbiAgICAgICAgICAgIGh0bWwuY2xhc3NMaXN0LnRvZ2dsZSgnd3AtZGFyay1tb2RlLWFjdGl2ZScpO1xyXG5cclxuICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLndwLWRhcmstbW9kZS1zd2l0Y2hlcicpLmZvckVhY2goKHN3aXRjaGVyKSA9PiBzd2l0Y2hlci5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnKSk7XHJcblxyXG4gICAgICAgICAgICBhcHAuY2hlY2tEYXJrTW9kZSgpO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgaXNfc2F2ZWQgPSBodG1sLmNsYXNzTGlzdC5jb250YWlucygnd3AtZGFyay1tb2RlLWFjdGl2ZScpID8gMSA6IDA7XHJcblxyXG4gICAgICAgICAgICBpZiAodHlwZW9mIHdwRGFya01vZGVBZG1pbiA9PT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgICAgICAgICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oJ3dwX2RhcmtfbW9kZV9mcm9udGVuZCcsIGlzX3NhdmVkKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oJ3dwX2RhcmtfbW9kZV9hZG1pbicsIGlzX3NhdmVkKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgd2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdkYXJrbW9kZUluaXQnKSk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqIGNoZWNrIGlmIHRoZSBkYXJrbW9kZSBpcyBhY3RpdmUgb3Igbm90IG9uIGluaXRpYWxpemUgKi9cclxuICAgICAgICBjaGVja0RhcmtNb2RlOiAoKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdodG1sJykuY2xhc3NMaXN0LmNvbnRhaW5zKCd3cC1kYXJrLW1vZGUtYWN0aXZlJykpIHtcclxuICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy53cC1kYXJrLW1vZGUtc3dpdGNoZXInKS5mb3JFYWNoKChzd2l0Y2hlcikgPT4gc3dpdGNoZXIuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJykpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLndwLWRhcmstbW9kZS1zd2l0Y2hlcicpLmZvckVhY2goKHN3aXRjaGVyKSA9PiBzd2l0Y2hlci5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBjaGVja09zTW9kZTogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAgICAgaWYgKCF3cERhcmtNb2RlRnJvbnRlbmQuZW5hYmxlX29zX21vZGUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdmFyIGRhcmtNZWRpYVF1ZXJ5ID0gd2luZG93Lm1hdGNoTWVkaWEoJyhwcmVmZXJzLWNvbG9yLXNjaGVtZTogZGFyayknKTtcclxuXHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAvLyBDaHJvbWUgJiBGaXJlZm94XHJcbiAgICAgICAgICAgICAgICBkYXJrTWVkaWFRdWVyeS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXdDb2xvclNjaGVtZSA9IGUubWF0Y2hlcyA/ICdkYXJrJyA6ICdsaWdodCc7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmICgnZGFyaycgPT09IG5ld0NvbG9yU2NoZW1lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2h0bWwnKS5jbGFzc0xpc3QuYWRkKCd3cC1kYXJrLW1vZGUtYWN0aXZlJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaHRtbCcpLmNsYXNzTGlzdC5yZW1vdmUoJ3dwLWRhcmstbW9kZS1hY3RpdmUnKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnZGFya21vZGVJbml0JykpO1xyXG5cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGNhdGNoIChlMSkge1xyXG4gICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBTYWZhcmlcclxuICAgICAgICAgICAgICAgICAgICBkYXJrTWVkaWFRdWVyeS5hZGRMaXN0ZW5lcihmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmV3Q29sb3JTY2hlbWUgPSBlLm1hdGNoZXMgPyAnZGFyaycgOiAnbGlnaHQnO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCdkYXJrJyA9PT0gbmV3Q29sb3JTY2hlbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2h0bWwnKS5jbGFzc0xpc3QuYWRkKCd3cC1kYXJrLW1vZGUtYWN0aXZlJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdodG1sJykuY2xhc3NMaXN0LnJlbW92ZSgnd3AtZGFyay1tb2RlLWFjdGl2ZScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ2Rhcmttb2RlSW5pdCcpKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlMikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZTIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvKiogY2hlY2sgaW5pdCBkYXJrIHRoZW1lICovXHJcbiAgICAgICAgICAgIGlmICh3aW5kb3cubWF0Y2hNZWRpYSAmJiB3aW5kb3cubWF0Y2hNZWRpYSgnKHByZWZlcnMtY29sb3Itc2NoZW1lOiBkYXJrKScpLm1hdGNoZXMpIHtcclxuICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2h0bWwnKS5jbGFzc0xpc3QuYWRkKCd3cC1kYXJrLW1vZGUtYWN0aXZlJyk7XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ2Rhcmttb2RlSW5pdCcpKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBoYW5kbGVFeGNsdWRlczogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAgICAgaWYgKHR5cGVvZiB3cERhcmtNb2RlRnJvbnRlbmQgPT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGVsZW1lbnRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCh3cERhcmtNb2RlRnJvbnRlbmQuZXhjbHVkZXMpO1xyXG5cclxuICAgICAgICAgICAgZWxlbWVudHMuZm9yRWFjaCgoZWxlbWVudCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKCd3cC1kYXJrLW1vZGUtaWdub3JlJyk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjaGlsZHJlbiA9IGVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnKicpO1xyXG5cclxuICAgICAgICAgICAgICAgIGNoaWxkcmVuLmZvckVhY2goKGNoaWxkKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hpbGQuY2xhc3NMaXN0LmFkZCgnd3AtZGFyay1tb2RlLWlnbm9yZScpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICB9O1xyXG5cclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBhcHAuaW5pdCk7XHJcblxyXG59KSgpOyJdLCJzb3VyY2VSb290IjoiIn0=